Release Notes: Extratropical Cyclone Tracker Transition to WCOSS2 - released to NCO on September 28, 2021

This notes is also posted on the google docs:
https://docs.google.com/document/d/1N8BBDHmyKHHOgIF9za2gVwzHe8kyWynqpXUolv9wUSo/edit

Due to upgrades of the supercomputers, the extratropical cyclone tracker has been modified to accommodate the new computer systems. Five (5) files and scripts have been modified and twenty nine (29) files were added. The version number has changed from v3.4.14 to v3.4.15.

Reason: Transition from WCOSS to WCOSS2.

List of external software used:
Simply load default prod modules with the latest versions. Check the module “prod_util/2.0.9”. If it is an earlier version (as of Sept. 28), update this module to 2.0.9.

Where is the release tag on subversion/git/vlab?
It is on Github by using the following address:
https://github.com/NOAA-EMC/ET_tracker
Under genesis_tracker.v3.4.15 branch

List of all code/scripts modified with this release:
        ecf/dev/jtracker_cens_00.sms.pbs
        ecf/dev/jtracker_cens_12.sms.pbs
        ecf/dev/jtracker_cmc_00.sms.pbs
        ecf/dev/jtracker_cmc_12.sms.pbs
        ecf/dev/jtracker_ecmwf_00.sms.pbs
        ecf/dev/jtracker_ecmwf_12.sms.pbs
        ecf/dev/jtracker_eens_00.sms.pbs
        ecf/dev/jtracker_eens_12.sms.pbs
        ecf/dev/jtracker_fens_00.sms.pbs
        ecf/dev/jtracker_fens_12.sms.pbs
        ecf/dev/jtracker_gefs_00.sms.pbs
        ecf/dev/jtracker_gefs_12.sms.pbs
        ecf/dev/jtracker_gfs_00.sms.pbs
        ecf/dev/jtracker_gfs_06.sms.pbs
        ecf/dev/jtracker_gfs_12.sms.pbs
        ecf/dev/jtracker_gfs_18.sms.pbs
        ecf/dev/jtracker_nam_00.sms.pbs
        ecf/dev/jtracker_nam_06.sms.pbs
        ecf/dev/jtracker_nam_12.sms.pbs
        ecf/dev/jtracker_nam_18.sms.pbs
        ecf/dev/jtracker_nvgm_00.sms.pbs
        ecf/dev/jtracker_nvgm_12.sms.pbs
        ecf/dev/jtracker_sref_03.sms.pbs
        ecf/dev/jtracker_sref_09.sms.pbs
        ecf/dev/jtracker_sref_15.sms.pbs
        ecf/dev/jtracker_sref_21.sms.pbs
        ecf/dev/jtracker_ukmet_00.sms.pbs
        ecf/dev/jtracker_ukmet_12.sms.pbs
The above job card scripts were added:
Changes were made to the job submission cards from BSUB to PBS and
corresponding resource requirements, path modifications, correct module
loading and others.

scripts/exgenesis_tracker_poe.sh.ecf:
APRUN format changed to new requirements and paths have been modified.

jobs/JTRACKER:
Original paths were replaced by WCOSS2 path.

sorc/build.scr
Modified for sourcing the targeted machine for module load.

ush/genesis_gettrk_poe.sh
ush/verify_pair_tcvit.sh
Cyclone vitals path modified to the new location.
        
modulefiles/gen_trkr.wcoss2
Added for new modules needed for the WOCSS2.

Were any other changes made that aren’t directly related to the transition?
No other changes were made not related to this addition.

Are there any changes to incoming data needs or outgoing products?
No.

If output filenames are changing, list the new filename.
N/A.

Compute resource information, for every job:
The resources are basically based on whether it is deterministic or ensemble models. For each deterministic model, only one task is needed. For ensemble models, the number of tasks are requested according to the number of members in the ensemble. Ensembles are executed using MPMD regime. This is the same as the assignments on the WCOSS P3.


Dissemination will remain the same.
HPSS archive retention will remain the same. (N/A)

What are your up and downstream dependencies?
All upstream model data (remain the same.)

Procedure to download the new version:
git clone https://github.com/NOAA-EMC/ET_tracker.git genesis_tracker.v3.4.15
cd genesis_tracker.v3.4.15
git checkout genesis_tracker.v3.4.15
Recompile the source code by "sh build.scr >& build.out"

Define paths in the job cards (make modifications to the corresponding NCO paths):
export NWROOT=/lfs/h2/emc/vpppg/noscrub/Guang.Ping.Lou
(WCOSS P3: NWROOT=/gpfs/dell1/nco/ops/nwprod)

export HOMEgenesis_tracker=$NWROOT/ET_tracker
(WCOSS P3:  HOMEgenesis_tracker=/gpfs/dell1/nco/ops/nwprod/genesis_tracker.v3.4.14)

export DCOMROOT=/lfs/h1/ops/$envir/dcom
(WCOSS P3:  DCOMROOT=/gpfs/dell1/nco/ops/dcom)

export COMROOT=/lfs/h1/ops/$envir/com
(WCOSS P3:  COMROOT=/gpfs/dell1/nco/ops/com)

export DATAROOT=/lfs/h2/emc/ptmp/Guang.Ping.Lou
(WCOSS P3:  DATAROOT=/gpfs/dell1/nco/ops/tmpnwprd)

The newer version jasper/2.0.25 and libjpeg/9c, and grib_util/1.2.3 must be loaded.
All 11 model outputs following need to be tested:
GFS, NAM, GEFS, SREF, CMC, CENS, FENS, NEVGEM, UKMET, ECMWF, EENS.

In the directory ecf/genesis_tracker, modify ecflow job cards based on job cards above:
jtracker_cens.ecf   jtracker_eens.ecf  jtracker_gfs.ecf   jtracker_sref.ecf
jtracker_cmc.ecf    jtracker_fens.ecf  jtracker_nam.ecf   jtracker_ukmet.ecf
jtracker_ecmwf.ecf  jtracker_gefs.ecf  jtracker_nvgm.ecf

-----------------------------------------------------
05/11/2020 release note:

Release Notes:  GEFS V12 Extratropical Cyclone Tracker Changes - released to NCO on May 11, 2020

Due to upgrades of GEFS to V12, from 21 members to 31 members and grib2 model output data resolution changes, the downstream component extratropical cyclone tracker is being modified to accommodate the model upgrades. Four files have been modified. 

Reason: Downstream updates due to GEFS V12 upgrades.
Where is the release tag on subversion/git/vlab? 
Use following address:
ssh://vlab.ncep.noaa.gov:29418/EMC_verif-genesis-tracker
 Under genesis_tracker.v3.4.12 branch
List of all code/scripts modified with this release
/ecf/dev/jtracker_gefs_00.sms.lsf
/ecf/genesis_tracker/jtracker_gefs.ecf
/scripts/exgenesis_tracker_poe.sh.ecf
/ush/genesis_gettrk_poe.sh
Changes were made to the above scripts:
Number of tasks increased from 21 to 31.
Number of members increased from 21 to 31.
Forecast hours changed from 2 digits to 3 digits.
Resolution changed from 1.0 to 0.5 degrees.
Were any other changes made that aren’t directly related to the transition?
No other changes were made not related to this addition.
Are there any changes to incoming data needs or outgoing products?
No. 
If output filenames are changing, list the new filename.
N/A.
Compute resource information, for every job:
	Tasks have increased from 21 to 31 due to increased members.
Additional disk space required is 35GB per year; data retention on disk will remain the same.
Dissemination will remain the same.
HPSS archive retention will remain the same. (N/A)
What are your up and downstream dependencies? 
All upstream model data (remain the same.)
Replace old /ecf/dev/jtracker_gefs_00.sms.lsf with new jtracker_gefs_00.sms.lsf
Replace /ecf/genesis_tracker/jtracker_gefs.ecf with new jtracker_gefs.ecf 
Replace /scripts/exgenesis_tracker_poe.sh.ecf with new exgenesis_tracker_poe.sh.ecf
Replace /ush/genesis_gettrk_poe.sh with new genesis_gettrk_poe.sh 
Note that set the correct path to GEFS V12 output data in /jobs/JTRACKER.


Guang Ping Lou -- 20150326

Release Notes:  Extratropical Cyclone Tracker genesis_tracker.v3.4.0
This release note is also available at
https://docs.google.com/a/noaa.gov/document/d/14x03_BwLt8RuKSwwFNmHgczb3MXYy7vL-XVawxeSzUU/edit

The program that extracts storm tracks from model forecasts are being upgraded in order to accommodate newly implemented GEFS changes and replacing input GRIB1 data with GRIB2 data where available. 

v3.3.3 - Released November 28, 2012
Initial transition to WCOSS 

v3.3.4 - Released August 20, 2013
Navy model name changes from ngps to nvgm 

v3.4.0 - Released April 1, 2015
Made changes to the FORTRAN code so that it can read either GRIB1 or GRIB2  model input data.  

Modified scripts to include GRIB1 and GRIB2 options; as well as namelist that reflects changes to the input data format; The following models have the options of either GRIB1 or GRIB2 input: GFS, GEFS, NAM, SREF, FENS, NVGM, UKMET. Other models do not have the GRIB2 data.

Added FNMOC ensemble cyclone tracks. The new addition has 20 members in total and the tracker runs twice a day at 00z and 12z. The tracker reads in GRIB1 input data because there is no analysis (0hour) fields in GRIB2 format. When 0 hour analysis data become available, the tracker can switch the GRIB2 input data on.

SREF new members addition in anticipation of its impending implementation. Reduced perturbation models from 3 to 2. Increased number of members from 21 to 26. Added GRIB2 capability. This implementation still uses GRIB1 input data until SREF is upgraded.

Deleted gettrk_main_gen.fd/orders.f because libw3 already contains the subroutine. 

Using new version of g2_d library.

output changes (include all changes to output generated by this tracker): 

Forecast tracks every 6 hours instead of 12 hours for models ECMWF, CMC, CENS, NVGM, because of 6 hourly data become available.

compute resource information (mandatory!  Include for all jobs.

Initiate FNMOC FENS ensemble forecasts cyclone tracking. Start a JTRACKER twice a day at 07:40 and 19:40Z for 00Z and 12Z forecasts, respectively. The ensemble data arrive around 07:21 and 17:21.

All other jobs remain the same frequency and same start time as they are now.

job runs parallel in form of POE (MPMD)

Runtime does not change.

additional disk space required per day (30MB/day).

frequency of run remain the same..

Data retains for files in /com/hur/prod/global/yyyy and the same as before. 

pre-implementation testing requirements

All model data should be tested as input for the cyclone tracker. production jobs should be tested as part of this implementation

This change does not require a 30-day evaluation.

The code manager will exam the test results.

Dissemination info:
where should this output be sent: N/A. The data will be processed internally and disseminated via graphics and paired tracks to users in other crontab jobs.  

who are the users: general public, universities, service centers, etc.

output files in /com/hur/prod/global/$yyyy should be transferred from PROD WCOSS to DEV WCOSS.

Is the code proprietary and is there any restricted data: The code is not proprietary and the data is not restricted except for ECMWF data which is protected via a pre-approval procedure.

Archive to HPSS
N/A

v3.4.5 - Oct 14, 2016
For phase 2 path change in NAM upgrade 

v3.4.7 -March 8, 2018
Service Change Notes:  Extratropical Cyclone Tracker genesis_tracker.v3.4.7
The program that extracts storm tracks from model forecasts are being upgraded in order to replace input data from Canadian models CMC and CENS.
The tracker is activated to extract tracks from CMC and CENS twice a day.
Canadian deterministic and ensemble models (CMC and CENS) data have been changed to grib2 format and higher resolution. The data locations have been moved to /gpfs/hps/nco/ops/com/naefs/$envir/cmce.$PDY/$CYC/pgrb2ap5/ and /dcomdev/us007003/$PDY/wgrbbul/cmc_gdps_25km /. The tracker needs to be modified accordingly.
v3.3.3 - Released November 28, 2012
•	Initial transition to WCOSS
v3.3.4 - Released August 20, 2013
•	Navy model name changes from ngps to nvgm
v3.4.0 - Released April 1, 2015, revised on June 1, 2015
•	The new upgraded extratropical cyclone tracker code and scripts are in SubVersion repository: https://svnemc.ncep.noaa.gov/pr
•	ojects/verif/stormtrk/trk_glbl/tags/genesis_tracker.v3.4.0/
v3.4.4 - Released August 1, 2016
•	Switch NAN's data from grib1 to grib2 input.
•	Change NAVGEM data input to /dcom/us007003 following NCO's directory changes.
•	Add FNMOC ensemble cyclone tracks. The new addition has 21 members in total and the tracker runs twice a day at 00z and 12z. The tracker reads in GRIB2 input.
•	Move all tracks to a new location /com2/gentracks/prod/$yyyy
•	The new upgraded extratropical cyclone tracker code and scripts are in SubVersion repository: hppts://svnemc.ncep.noaa.gov/projects/verif/stormtrk/trk_glbl/tags/
v3.4.7 - Released April, 2018
•	Change CMC and CENS data from grib1 to grib2 input
•	Change CMC deterministic model input data path to  /dcomdev/us007003/$PDY/wgrbbul/cmc_gdps_25km
•	Change ensemble model input data to /gpfs/hps/nco/ops/com/naefs/$envir/cmce.$PDY/$CYC/pgrb2ap5/
•	Modify several scripts so that it can handle new data formats.
•	Modify ECMWF input data’s dates - there is no need to wait for this data.
•	Extend GEFS tracking to 354 hours from 180 hours.
Output changes (include all changes to output generated by this tracker):
•	GEFS tracks have been extended to 354 hours from 180 hours.
Compute resource information (mandatory!  Include for all jobs.)
•	Increase wall time for GEFS for 10 minutes from 40 minutes to 50 minutes (for safety purposes).  
•	Increase disk space 22 mb per cycle.
Pre-implementation testing requirements
•	All model data should be tested as input for the cyclone tracker.
•	This change does not require a 30-day evaluation. 
•	The code manager will exam the test results.
Implementation
•	Check out files from the VLAB repository listed below:
https://vlab.ncep.noaa.gov/redmine/projects/emc-verif/repository/revisions/stormtrk/show/trk_glbl
      With sub-branch: EMC_verif/trk_glbl/tags/genesis_tracker.v3.4.7
•	Five scripts have been modified and no FORTRAN source code changes. 
            jobs/JTRACKER
            scripts/exgenesis_tracker_poe.sh.ecf
             ush/tcvit.sh
             ush/genesis_gettrk_poe.sh
             ecf/jtracker_gefs_hh.sms.lsf where hh=cycle hour
 Include dissemination info
•	Where should this output be sent: N/A. The data will be processed internally and disseminated via graphics and paired tracks to users in other crontab jobs.
 Who are the users: 
•	general public, universities, service centers, etc.
Is the code proprietary and is there any restricted date: •	The code is not proprietary and the data is not restricted.
 Archive to HPSS: N/A

20190827:
Release Notes:  Genesis Tracker - released to NCO on September 30, 2019
This version changes model input data locations where necessary to accommodate the decommission of Phase 1. The output tracks are as well relocated to a more concentrated directory (gentracks). Several scripts were modified to accommodate the transition from Phase 1 to Dell due to computing configuration changes and library modularization.

Transition to from Tide/Gyre Phase 1 to Venus/Mars
Where is the release tag on subversion/git/vlab?
https://vlab.ncep.noaa.gov/redmine/projects/emc-verif-tracker/repository?utf8=%E2%9C%93&rev=genesis_tracker.v3.4.9
List of external software used: nceplibs modules
w3emc/2.3.0, w3nco/2.0.6, bacio/2.0.2, sp/2.02, g2/3.1.0, jasper/1.900.29, libpng/1.2.59, zlib/1.2.11, grib_util/1.0.6	
List of all code/scripts modified with this release
/jobs/JTRACKER
/scripts/exgenesis_tracker_poe.sh.ecf
/ush/genesis_gettrk_poe.sh
/ush/verify_pair_tcvit.sh
/ush/verify_pair_glbl.sh
/ush/tcvit.sh
/ecf/all files
/sorc/*/makefile
/sorc/machine-setup.sh            ---added
/sorc/build.scr
/modulefiles/gen_trkr.wcoss_dell_p3. Etc.   --- added
Changes were made to the above code/scripts:
 COMROOT is changed to COMROOTp3:
export COMROOTp3=/gpfs/dell1/nco/ops/com
Old: export COMROOT=/gpfs/tp2/nco/ops/com
export optrack=$COMOUT/plot 
Old: export optrack=$COMOMB/plot
etc.

                  2. Change tracker output from various locations to this unified directory, they should                    be scrubbed after a few days: 
COMOUT=${COMROOTp3}/gentracks/${envir}/${RUN}.$PDY/track

      3. Move all files below before the transition: 
                    Move /gpfs/tp2/nco/ops/com/gentracks/prod/gentracks/YYYY
	        To /gpfs/dell1/nco/ops/com//gentracks/prod/gentracks/YYYY
                    These files are not to be removed and they are permanent.

	      4. Move following files before transition as well and they are permanent:
                     Move /gpfs/tp1/nco/ops/com/arch/prod/syndat/
                     To /gpfs/dell1/nco/ops/com/arch/prod/syndat/ 
                        Or /gpfs/dell1/nco/ops/com/gfs/prod/syndat/   (decided by GFS)

	      5. Change input model locations for the following models Because we don’t know the locations yet as of today.
COMIN=/gpfs/gp1/nco/ops/dcom/us007003/20190821/wgrbbul/fnmocens_gb2
COMIN=/gpfs/gp1/nco/ops/dcom/us007003/20190821/wgrbbul/ecmwf
COMIN=/gpfs/gp1/nco/ops/com/hourly/prod/eens.20190821
COMIN=/gpfs/gp1/nco/ops/dcom/us007003/20190821/wgrbbul/cmc_gdps_25km
COMIN=/gpfs/gp1/nco/ops/dcom/us007003/navgem

                 6. /scripts/exgenesis_tracker_poe.sh.ecf ---- computing environment changes.
	     7. /ush/genesis_gettrk_poe.sh   ---- utility paths changes.
                8. /ush/verify_pair_tcvit.sh          ---- utility paths changes    
     9. /ush/verify_pair_glbl.sh          ---- utility paths changes
    10. /ush/tcvit.sh                           ---- utility paths changes
    11. /modulefiles/gen_trkr.wcoss_dell_p3  --- added 4 modules files for different platforms
    12. /sorc/machine-setup.sh       ---- add this file to identify which machine 
    13. /sorc/build.scr                       ---- using modules to compile code
         Recompile the code --- sh buld.src
    14. /ecf/genesis/jtracker_????.ecf          ---- changed output to P3
Were any other changes made that aren’t directly related to the transition?
	No other changes were made not related to this transition.
Are there any changes to incoming data needs or outgoing products?
No. 
If output filenames are changing, list the current and new filename.
N/A.
Compute resource information, for every job:
	Remain the same.
Disk space required per day or per cycle; data retention on disk will remain the same.
Dissemination will remain the same.
HPSS archive retention will remain the same. (N/A)
What are your up and downstream dependencies? 
All upstream model data (remain the same.)

